<div class="flex flex-col items-center">
  <div class="flex h-full flex-col items-center">
    <!-- Title and Edit Icon-->
    <div class="mb-dl-6 flex w-full justify-between px-dl-5">
      <p
        class="mb-dl-3 pt-dl-3 text-dl-7 font-dl-3 text-dl-grey-2 dark:text-dl-grey-9"
      >
        Shopping In Progress
      </p>
      <svg
        class="invisible mt-dl-4"
        width="50"
        height="50"
        viewBox="0 0 15 15"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        (click)="toggleMenu($event)"
      >
        <path
          d="M3.625 7.5C3.625 8.12132 3.12132 8.625 2.5 8.625C1.87868 8.625 1.375 8.12132 1.375 7.5C1.375 6.87868 1.87868 6.375 2.5 6.375C3.12132 6.375 3.625 6.87868 3.625 7.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM12.5 8.625C13.1213 8.625 13.625 8.12132 13.625 7.5C13.625 6.87868 13.1213 6.375 12.5 6.375C11.8787 6.375 11.375 6.87868 11.375 7.5C11.375 8.12132 11.8787 8.625 12.5 8.625Z"
          fill="currentColor"
          fill-rule="evenodd"
          clip-rule="evenodd"
        ></path>
      </svg>
      <div
        #menu
        *ngIf="menuOpen"
        class="focus:outling-none absolute right-16 top-2 z-10 flex flex-col rounded-dl-1 bg-white shadow-md ring-1 ring-dl-grey-1 ring-opacity-5 ease-out dark:bg-dl-grey-1"
      >
        <button
          (click)="onDeleteClick()"
          type="button"
          class="block cursor-pointer px-dl-3 py-dl-2 text-dl-5 text-dl-grey-3 hover:bg-dl-grey-10 dark:text-dl-grey-8 dark:hover:bg-dl-grey-2"
        >
          Delete List
        </button>
      </div>
    </div>

    <!-- Header Row -->
    <div class="mb-dl-5 flex w-full justify-between px-dl-5">
      <p
        class="mb-dl-3 ml-dl-9 mt-dl-5 text-dl-6 font-dl-3 text-dl-grey-2 dark:text-dl-grey-9"
      >
        Item
      </p>
      <p
        class="mb-dl-3 mr-dl-5 mt-dl-5 text-dl-6 font-dl-3 text-dl-grey-2 dark:text-dl-grey-9"
      >
        Purchased Amount
      </p>
    </div>
    <!-- List -->
    <div
      *ngIf="!isLoading()"
      class="relative mb-dl-2 flex max-h-dl-18 w-dl-16 flex-col items-center overflow-y-auto"
    >
      <div
        class="relative mb-dl-3 flex w-full items-center justify-between rounded-dl-2 bg-dl-grey-10 px-dl-5 py-dl-2 dark:bg-dl-grey-2"
        *ngFor="let item of displaySLIngr().items"
      >
        <div
          class="mr-dl-2 flex h-dl-4 items-center justify-between rounded-dl-2 pr-3"
        >
          <!-- Green Checkbox (only if item is already purchased and saved)-->
          <svg
            *ngIf="item.store"
            version="1.1"
            height="22"
            width="22"
            viewBox="-949 951 110 105"
          >
            <switch>
              <g i:extraneous="self">
                <g>
                  <path
                    [attr.fill]="getFillColor(1)"
                    d="M-873.7,953.5h-50.5c-12.3,0-22.2,10-22.2,22.2v50.5c0,12.3,10,22.2,22.2,22.2h50.5c12.3,0,22.2-10,22.2-22.2v-50.5     C-851.5,963.5-861.5,953.5-873.7,953.5z M-874.1,995.8l-24.5,24.5c-1.5,1.5-3.5,2.3-5.5,2.3s-4.1-0.8-5.5-2.3l-14.1-14.1     c-3.1-3.1-3.1-8,0-11.1c3.1-3.1,8-3.1,11.1,0l8.6,8.6l19-19c3.1-3.1,8-3.1,11.1,0C-871.1,987.8-871.1,992.8-874.1,995.8z"
                  />
                </g>
              </g>
            </switch>
          </svg>
          <!-- Grey Trashcan (only if item 'purchasedMeasurement' is not present)-->
          <svg
            *ngIf="
              (!item.store && !item.purchasedMeasurement) ||
              item.purchasedMeasurement < item.needMeasurement
            "
            xmlns="http://www.w3.org/2000/svg"
            data-name="Layer 1"
            viewBox="20 20 70 75"
            height="22"
            width="22"
            (click)="onDeleteItemClick(item.shoppingListIngredientID)"
          >
            <path
              [attr.fill]="getFillColor(2)"
              d="M22,41h4.94l.12,1L30.84,73.2A10,10,0,0,0,40.77,82H59.23a10,10,0,0,0,9.93-8.8L72.94,42l.12-1H78a4,4,0,0,0,4-4.39A4.12,4.12,0,0,0,77.83,33H22.17A4.12,4.12,0,0,0,18,36.61,4,4,0,0,0,22,41Zm43,0L61.21,72.24a2,2,0,0,1-2,1.76H40.77a2,2,0,0,1-2-1.76L35,41Z"
            />
            <path d="M44,18a4,4,0,0,0,0,8H56a4,4,0,0,0,0-8Z" />
          </svg>
          <!-- Pink Checkbox (only if item 'purchasedMeasurement' is present but not yet saved)-->
          <svg
            *ngIf="!item.store && item.purchasedMeasurement && item.valueValid"
            xmlns:x="http://ns.adobe.com/Extensibility/1.0/"
            xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/"
            xmlns:graph="http://ns.adobe.com/Graphs/1.0/"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            version="1.1"
            height="22"
            width="22"
            viewBox="-949 951 110 105"
          >
            <switch>
              <g i:extraneous="self">
                <g>
                  <path
                    [attr.fill]="getFillColor(3)"
                    d="M-873.7,953.5h-50.5c-12.3,0-22.2,10-22.2,22.2v50.5c0,12.3,10,22.2,22.2,22.2h50.5c12.3,0,22.2-10,22.2-22.2v-50.5     C-851.5,963.5-861.5,953.5-873.7,953.5z M-874.1,995.8l-24.5,24.5c-1.5,1.5-3.5,2.3-5.5,2.3s-4.1-0.8-5.5-2.3l-14.1-14.1     c-3.1-3.1-3.1-8,0-11.1c3.1-3.1,8-3.1,11.1,0l8.6,8.6l19-19c3.1-3.1,8-3.1,11.1,0C-871.1,987.8-871.1,992.8-874.1,995.8z"
                  />
                </g>
              </g>
            </switch>
          </svg>
          <!-- Box to cover Checkmark (only if item 'purchasedMeasurement' is present but not yet saved)-->
          <div
            *ngIf="!item.store && item.purchasedMeasurement && item.valueValid"
            class="absolute left-5 top-5 z-20 h-3 w-4 bg-dl-pink-7 dark:bg-dl-pink-4"
          ></div>

          <div class="ml-dl-4 flex flex-col">
            <span
              class="text-dl-5 font-dl-3 text-dl-grey-1 dark:text-dl-grey-10"
            >
              {{ item.name }}
            </span>
            <span
              class="text-dl-5 font-dl-2 text-dl-grey-3 dark:text-dl-grey-8"
            >
              {{ Math.ceil(item.needMeasurement) }} {{ item.needUnit }}
            </span>
          </div>
        </div>
        <div class="relative flex items-center justify-between">
          <!-- <p class="mr-dl-2 text-dl-4 font-dl-2 italic text-dl-grey-4 dark:text-dl-grey-7">
            {{ item.needUnit }}s
          </p> -->
          <p
            *ngIf="!item.valueValid"
            class="-right-22 absolute -bottom-1 mr-dl-2 w-dl-10 text-dl-4 font-dl-3 text-dl-red-4 dark:text-dl-red-7"
          >
            buy more
          </p>
          <input
            class="rounded-dl-1 border-0"
            *ngIf="!item.store"
            type="number"
            [min]="item.needMeasurement"
            max="999"
            placeholder="0"
            [(ngModel)]="item.purchasedAmount"
            [ngClass]="{
              invisible: item.store
            }"
            (ngModelChange)="
              onPurchasedAmountChange(item.ingredientID, item.purchasedAmount)
            "
          />
          <div
            class="mr-dl-3 flex w-dl-6 flex-col items-center"
            *ngIf="item.store"
          >
            <p class="text-dl-5 font-dl-3 text-dl-grey-2 dark:text-dl-grey-9">
              {{ Math.ceil(item.purchasedMeasurement) }}
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Spacer div -->
    <div class="flex-grow"></div>

    <!-- Save Button -->
    <button
      type="button"
      *ngIf="isLoading() === false && displaySLIngr().itemsToSave.length"
      class="mb-dl-2 block h-dl-5 w-dl-16 whitespace-nowrap rounded-dl-1 border bg-dl-pink-4 px-dl-1 py-dl-1 text-center text-dl-4 font-dl-3 text-white shadow-lg transition-all duration-200 ease-in-out dark:bg-dl-pink-7 dark:text-dl-grey-1"
      (click)="onSaveClick()"
    >
      {{ saveButtonText }}
    </button>
  </div>
  <div
    *ngIf="isDeleting() === true || isLoading() === true"
    class="flex h-full w-full items-center justify-center"
  >
    <mat-spinner class="my-app-custom-spinner"></mat-spinner>
  </div>
</div>
