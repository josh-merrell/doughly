<script src="https://accounts.google.com/gsi/client" async></script>
<div
  class="flex h-full w-full flex-col items-center bg-dl-tan-9 px-dl-2 py-dl-6 dark:bg-dl-tan-1 sm:px-dl-6 lg:px-dl-8"
>
  <div class="mt-dl-3 w-full items-center justify-center">
    <img
      class="mx-auto h-12 w-auto"
      [src]="imagePlaceholder"
      alt="doughleap logo"
    />
  </div>
  <!-- Spacer -->
  <div class="flex flex-grow"></div>

  <mat-spinner
    class="my-app-custom-spinner w-full"
    [diameter]="84"
    *ngIf="isLoading()"
  ></mat-spinner>
  <div *ngIf="!isLoading()">
    <!--main card-->
    <form
      [formGroup]="login_form"
      (ngSubmit)="onSubmit()"
      class="flex flex-col items-center"
    >
      <div class="relative mb-dl-5 flex flex-col">
        <div class="mt-dl-4 text-center">
          <!-- <h3 class="leading-dl-4 text-dl-6 font-dl-3 text-dl-tan-3 dark:text-dl-tan-8">Sign In</h3> -->
        </div>
      </div>
      <!-- OAuth Sign In -->
      <div class="mb-dl-8 flex w-full flex-col items-center justify-between">
        <button
          (click)="signInWithGoogle()"
          class="gsi-material-button !w-dl-15 bg-dl-tan-10 dark:border dark:border-dl-tan-7 dark:bg-dl-tan-2"
        >
          <div class="gsi-material-button-state"></div>
          <div class="gsi-material-button-content-wrapper">
            <div class="gsi-material-button-icon">
              <svg
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 48 48"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                style="display: block"
              >
                <path
                  fill="#EA4335"
                  d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"
                ></path>
                <path
                  fill="#4285F4"
                  d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"
                ></path>
                <path
                  fill="#FBBC05"
                  d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"
                ></path>
                <path
                  fill="#34A853"
                  d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"
                ></path>
                <path fill="none" d="M0 0h48v48H0z"></path>
              </svg>
            </div>
            <span
              class="gsi-material-button-contents text-dl-tan-1 dark:text-dl-tan-10"
              >Sign in with Google</span
            >
            <span style="display: none">Sign in with Google</span>
          </div>
        </button>
        <button
          (click)="signInWithFacebook()"
          class="gsi-material-button mt-dl-2 !w-dl-15 bg-dl-tan-10 dark:border dark:border-dl-tan-7 dark:bg-dl-tan-2"
        >
          <div class="gsi-material-button-state"></div>
          <div class="gsi-material-button-content-wrapper">
            <div class="gsi-material-button-icon flex items-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                enable-background="new 0 0 56.693 56.693"
                id="Layer_1"
                fill="#1877F2"
                version="1.1"
                height="20px"
                width="20px"
                viewBox="5 4 48 50"
                xml:space="preserve"
              >
                <path
                  d="M40.43,21.739h-7.645v-5.014c0-1.883,1.248-2.322,2.127-2.322c0.877,0,5.395,0,5.395,0V6.125l-7.43-0.029  c-8.248,0-10.125,6.174-10.125,10.125v5.518h-4.77v8.53h4.77c0,10.947,0,24.137,0,24.137h10.033c0,0,0-13.32,0-24.137h6.77  L40.43,21.739z"
                />
              </svg>
            </div>
            <span
              class="gsi-material-button-contents text-dl-tan-1 dark:text-dl-tan-10"
              >Sign in with Facebook</span
            >
            <span style="display: none">Sign in with Facebook</span>
          </div>
        </button>
        <button
          (click)="signInWithApple()"
          class="gsi-material-button mt-dl-2 !w-dl-15 bg-dl-tan-10 dark:border dark:border-dl-tan-7 dark:bg-dl-tan-2"
        >
          <div class="gsi-material-button-state"></div>
          <div class="gsi-material-button-content-wrapper">
            <div class="gsi-material-button-icon flex items-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                height="2500"
                width="2158"
                viewBox="0 -3.552713678800501e-15 880 1050"
              >
                <path
                  class="fill-current text-black dark:text-white"
                  d="M404.345 229.846c52.467 0 98.494-20.488 138.08-61.465s59.38-88.626 59.38-142.947c0-5.966-.472-14.444-1.414-25.434-6.912.942-12.096 1.727-15.552 2.355-48.383 6.908-90.954 30.615-127.713 71.12-36.758 40.506-55.137 83.838-55.137 129.996 0 5.337.785 14.13 2.356 26.375zM592.379 950c37.387 0 78.701-25.59 123.943-76.772S796.122 761.915 820 692.836c-88.912-45.844-133.368-111.626-133.368-197.348 0-71.591 35.973-132.82 107.92-183.688-49.954-62.486-115.931-93.729-197.931-93.729-34.56 0-66.134 5.181-94.724 15.543l-17.908 6.594-24.035 9.42c-15.709 5.966-30.004 8.95-42.885 8.95-10.054 0-23.25-3.455-39.586-10.363l-18.38-7.536-17.436-7.065c-25.449-10.676-52.782-16.014-82-16.014-78.23 0-141.065 26.376-188.506 79.128C23.72 349.479 0 419.03 0 505.379c0 121.517 38.015 233.772 114.046 336.763C166.828 914.047 215.054 950 258.724 950c18.537 0 36.916-3.611 55.138-10.833l23.092-9.42 18.38-6.594c25.762-9.106 49.482-13.659 71.16-13.659 22.935 0 49.326 5.81 79.173 17.427l14.609 5.652C550.75 944.191 574.786 950 592.379 950z"
                />
              </svg>
            </div>
            <span
              class="gsi-material-button-contents text-dl-tan-1 dark:text-dl-tan-10"
              >Sign in with Apple</span
            >
            <span style="display: none">Sign in with Apple</span>
          </div>
        </button>
      </div>
      <!--FORM FIELDS-->
      <div id="form-email">
        <div class="relative mb-dl-2 flex flex-col">
          <label
            class="mb-dl-1 ml-dl-1 text-dl-5 font-dl-3 text-dl-tan-1 dark:text-dl-tan-10"
            for="email"
            >Email</label
          >
          <div class="w-dl-15">
            <input
              type="email"
              formControlName="email"
              class="w-dl-15 rounded-full border-0 p-dl-2 pl-dl-5 text-dl-tan-2 ring-1 ring-inset ring-dl-tan-7 placeholder:text-dl-tan-6 focus:ring-2 focus:ring-inset focus:ring-dl-green-5 dark:bg-dl-tan-2 dark:text-dl-tan-9"
              appAutofocus
              tabindex="1"
            />

            <div
              [ngClass]="{
                invisible:
                  !login_form.get('email')!.touched ||
                  login_form.get('email')!.valid
              }"
              class="mt-dl-1 text-dl-4 font-dl-2 text-dl-red-5 dark:text-dl-red-8"
            >
              Please enter a valid email.
            </div>
          </div>
        </div>
      </div>

      <div id="form-password">
        <div class="relative mb-dl-3 flex flex-col">
          <label
            class="mb-dl-1 ml-dl-1 text-dl-5 font-dl-3 text-dl-tan-1 dark:text-dl-tan-10"
            for="password"
            >Password</label
          >
          <div class="w-dl-15">
            <input
              type="password"
              formControlName="password"
              class="w-dl-15 rounded-full border-0 p-dl-2 pl-dl-5 text-dl-tan-2 ring-1 ring-inset ring-dl-tan-7 placeholder:text-dl-tan-6 focus:ring-2 focus:ring-inset focus:ring-dl-green-5 dark:bg-dl-tan-2 dark:text-dl-tan-9"
              tabindex="2"
            />
            <div
              [ngClass]="{
                invisible:
                  !login_form.get('password')!.touched ||
                  login_form.get('password')!.valid
              }"
              class="mt-dl-1 text-dl-4 font-dl-2 text-dl-red-5 dark:text-dl-red-8"
            >
              Minimum password length is 6 characters.
            </div>
          </div>
        </div>
      </div>

      <!---->

      <div
        class="mx-dl-2 mb-dl-4 flex items-center justify-between"
        style="width: 296px"
      >
        <div class="leading-dl-6 text-dl-2" (click)="resetPassword()">
          <a
            class="cursor-pointer text-dl-5 font-dl-3 text-dl-green-5 hover:text-dl-green-5 dark:text-dl-green-6 dark:hover:text-dl-green-6"
            [ngClass]="{
              invisible: !showPasswordReset()
            }"
            >Forgot password?</a
          >
        </div>
      </div>

      <button
        type="submit"
        [disabled]="
          login_form.invalid ||
          login_form.get('email')!.touched === false ||
          login_form.get('password')!.touched === false ||
          login_form.get('password')!.value === '' ||
          login_form.get('email')!.value === ''
        "
        style="height: 40px; width: 296px"
        class="shadow-s inline-flex items-center justify-center rounded-full text-dl-5 font-dl-2 text-dl-tan-10 dark:text-dl-tan-1"
        [ngClass]="{
          'cursor-pointer bg-dl-green-4 hover:bg-dl-green-5 dark:bg-dl-green-7 hover:dark:bg-dl-green-6':
            login_form.invalid === false,
          'bg-dl-tan-7':
            login_form.invalid ||
            login_form.get('password')!.value === '' ||
            login_form.get('email')!.value === ''
        }"
        tabindex="3"
      >
        Sign In with Email
      </button>
    </form>

    <p
      *ngIf="loginFailureMessage()"
      class="mt-dl-4 text-center text-dl-5 text-dl-red-5 dark:text-dl-red-6"
    >
      {{ loginFailureMessage() }}
    </p>
    <p
      *ngIf="successMessage()"
      class="mt-dl-4 text-center text-dl-5 text-dl-teal-4 dark:text-dl-teal-7"
    >
      {{ successMessage() }}
    </p>
    <p class="mt-dl-4 text-center text-dl-5 text-dl-tan-4 dark:text-dl-tan-8">
      New here?
      <a
        class="ml-dl-2 cursor-pointer text-dl-5 font-dl-3 leading-dl-2 text-dl-green-5 dark:text-dl-green-6"
        routerLink="/register"
        tabindex="4"
        >Create an account</a
      >
    </p>
  </div>
  <!-- Spacer -->
  <div class="flex flex-grow"></div>
</div>
