<div class="relative">
  <nav
    class="border-t-2 border-dl-tan-8 bg-dl-tan-9 dark:border-dl-tan-3 dark:bg-dl-tan-1"
  >
    <!-- Adding Recipe Banner -->
    <div
      *ngIf="
        addingRecipe() && currentLocation() !== '/recipes/created/add/vision'
      "
      class="absolute -top-4 left-1/2 flex -translate-x-1/2 items-center rounded-full bg-dl-pinknew-9 px-dl-4 py-dl-2 dark:bg-dl-pinknew-2"
    >
      <p
        class="mr-dl-2 font-body text-dl-4 text-dl-pinknew-2 dark:text-dl-pinknew-9"
      >
        Adding Recipe...
      </p>
      <mat-spinner class="my-app-custom-spinner" [diameter]="18"></mat-spinner>
    </div>
    <!-- Mobile menu, show/hide based on menu state. -->
    <div class="flex justify-center" id="mobile-menu">
      <div
        class="flex w-full items-center justify-between space-y-1 px-dl-2 pt-1"
      >
        <!-- Subscription Page -->
        <div
          class="relative flex flex-col px-dl-0 pb-dl-3"
          (click)="navigateToProducts()"
        >
          <ng-lottie
            containerClass="pb-dl-4"
            height="57px"
            width="57px"
            (animationCreated)="animationCreated($event)"
            (loopComplete)="loopComplete()"
            [options]="animationOptions"
          />
          <a
            class="absolute -top-1 right-0 font-sans text-dl-4 font-dl-3"
            [ngClass]="{
              'text-dl-red-3 dark:text-dl-red-7': creditCountRed(),
              'text-dl-tan-1 dark:text-dl-tan-10': !creditCountRed()
            }"
          >
            {{ profile.permAITokenCount }}
          </a>
        </div>
        <ng-container *ngIf="authService.profile() as profile">
          <div (click)="navigate('/groceries')" class="flex flex-col">
            <svg
              version="1.1"
              [ngClass]="{
                'border-dl-green-8 text-dl-tan-1 dark:text-dl-tan-10':
                  getURL() === 'groceries',
                'border-transparent text-dl-tan-5 dark:text-dl-tan-6 ':
                  getURL() !== 'groceries'
              }"
              class="ml-dl-1 inline-flex items-center"
              height="48"
              width="48"
              viewBox="-14 0 67 71"
              enable-background="new 0 0 84 64"
              xml:space="preserve"
            >
              <path
                [attr.fill]="this.extraStuffService.getFillColor(2)"
                d="M54.365,22.459c-0.023-0.06-0.063-0.108-0.101-0.158c-0.02-0.027-0.028-0.058-0.052-0.082  c-0.002-0.002-0.004-0.002-0.006-0.004c-0.054-0.055-0.12-0.095-0.188-0.131c-0.019-0.01-0.033-0.027-0.053-0.035  c-0.021-0.009-0.046-0.008-0.067-0.015c-0.072-0.022-0.145-0.043-0.22-0.044c-0.002,0-0.004-0.001-0.007-0.001  c-0.032,0-0.06,0.014-0.09,0.018c-0.064,0.008-0.129,0.014-0.19,0.039c-0.052,0.021-0.094,0.057-0.14,0.088  c-0.032,0.023-0.07,0.035-0.1,0.063l-3.906,3.748l2.681-7.053c0.912-2.403,0.126-5.038-1.758-6.587  c3.114-2.038,4.671-4.13,4.266-5.824c-0.233-0.979-1.114-1.633-2.297-1.709c-1.456-0.089-3.265,0.652-4.813,2.364  c-0.025-2.317-0.891-4.079-2.022-4.961c-0.933-0.727-2.025-0.825-2.853-0.248c-1.428,0.998-1.653,3.595-0.679,7.187  c-2.436-0.091-4.775,1.355-5.689,3.759l-3.56,9.371l-0.047-0.045c-0.29-0.278-0.749-0.278-1.039,0l-0.673,0.646  c-0.091-1.738-0.333-3.523-0.722-5.326C28.011,8.102,22.727,1.519,18.005,2.54c-3.438,0.741-5.478,5.288-5.553,11.339  c-0.033,0.199-0.031,0.398-0.009,0.597c0.019,2.088,0.267,4.341,0.769,6.67c0,0,0,0.001,0,0.001s0,0,0,0.001  c0.355,1.646,0.823,3.222,1.382,4.719l-3.822-3.671c-0.026-0.025-0.061-0.036-0.089-0.057c-0.049-0.035-0.095-0.073-0.151-0.095  c-0.057-0.023-0.117-0.028-0.177-0.036c-0.035-0.005-0.066-0.021-0.103-0.021c-0.002,0-0.005,0.001-0.008,0.001  c-0.07,0.001-0.137,0.021-0.205,0.042c-0.027,0.008-0.057,0.007-0.082,0.018c-0.016,0.006-0.028,0.021-0.043,0.029  c-0.072,0.037-0.141,0.079-0.197,0.136c-0.002,0.002-0.004,0.002-0.006,0.004c-0.025,0.026-0.036,0.06-0.056,0.088  c-0.036,0.049-0.074,0.095-0.097,0.152c-0.023,0.058-0.028,0.119-0.036,0.18c-0.005,0.034-0.02,0.064-0.02,0.099v37.236  c0,1.365,1.25,2.477,2.787,2.477h39.344c1.537,0,2.787-1.111,2.787-2.477V22.738c0-0.034-0.015-0.063-0.02-0.096  C54.395,22.58,54.39,22.518,54.365,22.459z M52.041,6.268c0.244,0.016,0.825,0.102,0.935,0.561c0.161,0.671-0.573,2.383-4.237,4.613  c-0.067-0.028-0.131-0.062-0.199-0.087l-1.737-0.66C48.322,7.313,50.709,6.185,52.041,6.268z M43.31,3.155  c0.386-0.27,0.878,0.05,1.071,0.201c1.042,0.813,2.085,3.25,0.977,6.789l-1.736-0.66c-0.069-0.026-0.139-0.044-0.208-0.067  C42.155,5.317,42.744,3.55,43.31,3.155z M37.484,13.404c0.851-2.238,3.359-3.371,5.604-2.517l2.458,0.935l0.001,0h0.001l2.458,0.935  c2.239,0.85,3.368,3.363,2.519,5.602l-2.993,7.872l-4.205-4.035c-0.291-0.278-0.748-0.278-1.039,0l-4.908,4.712l-3.682-3.537  L37.484,13.404z M18.322,4.006c3.757-0.815,8.462,5.521,10.253,13.828c0.472,2.189,0.71,4.345,0.722,6.417l-2.768,2.658  l-4.906-4.712c-0.29-0.278-0.749-0.278-1.039,0l-4.224,4.058c-0.691-1.675-1.255-3.47-1.667-5.364  c0.25-0.617,3.144-2.214,8.21-3.306c0.405-0.087,0.662-0.486,0.575-0.892c-0.087-0.405-0.489-0.662-0.892-0.575  c-2.53,0.545-4.865,1.289-6.576,2.093c-0.674,0.317-1.213,0.632-1.645,0.945c-0.292-1.797-0.415-3.539-0.397-5.171  c0.307-0.94,2.195-2.369,5.264-3.031c0.405-0.087,0.662-0.486,0.575-0.891c-0.087-0.405-0.486-0.664-0.891-0.575  c-1.985,0.428-3.652,1.169-4.802,2.053C14.571,7.46,16.066,4.493,18.322,4.006z M51.635,60.95H12.291  c-0.698,0-1.287-0.447-1.287-0.977V24.498l4.156,3.992c0.29,0.278,0.749,0.278,1.039,0l4.905-4.712l4.906,4.712  c0.29,0.278,0.749,0.278,1.039,0l3.519-3.379c0.008-0.008,0.017-0.015,0.024-0.023l1.364-1.31l0.345,0.331  c0.001,0.001,0.003,0.003,0.005,0.005l4.554,4.376c0.291,0.278,0.748,0.278,1.039,0l4.908-4.712l4.913,4.713  c0.146,0.139,0.332,0.208,0.52,0.208s0.374-0.069,0.52-0.208l4.163-3.994v35.477C52.922,60.503,52.332,60.95,51.635,60.95z"
              />
            </svg>
            <a
              [ngClass]="{
                'border-dl-green-8 text-dl-tan-1 dark:text-dl-tan-10':
                  getURL() === 'groceries',
                'border-transparent text-dl-tan-4 dark:text-dl-tan-7 ':
                  getURL() !== 'groceries'
              }"
              class="inline-flex items-center border-t-4 px-1 font-sans text-dl-4 font-dl-3"
            >
              Groceries
            </a>
          </div>
        </ng-container>
        <ng-container *ngIf="authService.profile() as profile">
          <div (click)="navigate('/recipes')" class="flex flex-col">
            <svg
              data-name="Layer 1"
              [ngClass]="{
                'border-dl-green-8 text-dl-tan-1 dark:text-dl-tan-10':
                  getURL() === 'recipes',
                'border-transparent text-dl-tan-5 dark:text-dl-tan-6 ':
                  getURL() !== 'recipes'
              }"
              class="inline-flex items-center"
              viewBox="-5 0 58 70"
              height="48"
              width="48"
            >
              <path
                [attr.fill]="this.extraStuffService.getFillColor(1)"
                d="M46,13H43V6a3,3,0,0,0-4-2.82L13.64,13.07h0l-.1.06a1,1,0,0,0-.21.14l-.08.1a1,1,0,0,0-.13.19,1.36,1.36,0,0,0-.09.36s0,0,0,.07V60a1,1,0,0,0,1,1H46a5,5,0,0,0,5-5V18A5,5,0,0,0,46,13ZM39.66,5.06A1,1,0,0,1,41,6v7H19.31ZM49,56a3,3,0,0,1-3,3H15V15H46a3,3,0,0,1,3,3Z"
              />
              <path
                [attr.fill]="this.extraStuffService.getFillColor(1)"
                d="M27.55,31.78V36a1,1,0,0,0,1,1h6.9a1,1,0,0,0,1-1V31.78a3.71,3.71,0,0,0-.26-7.41,3.67,3.67,0,0,0-.51,0,3.71,3.71,0,0,0-7.36,0,3.67,3.67,0,0,0-.51,0,3.71,3.71,0,0,0-.26,7.41Zm.26-5.41a1.68,1.68,0,0,1,1.08.38,1,1,0,0,0,1.55-1.18,1.74,1.74,0,0,1-.15-.7,1.71,1.71,0,0,1,3.42,0,1.74,1.74,0,0,1-.15.7,1,1,0,0,0,1.55,1.18,1.68,1.68,0,0,1,1.08-.38,1.71,1.71,0,1,1,0,3.42,1.58,1.58,0,0,1-.46-.06,1,1,0,0,0-1.28,1v3.25h-4.9V30.68a1,1,0,0,0-1.28-1,1.58,1.58,0,0,1-.46.06,1.71,1.71,0,0,1,0-3.42Z"
              />
              <path
                [attr.fill]="this.extraStuffService.getFillColor(1)"
                d="M38,43H26a1,1,0,0,0,0,2H38a1,1,0,0,0,0-2Z"
              />
              <path
                [attr.fill]="this.extraStuffService.getFillColor(1)"
                d="M43,47H21a1,1,0,0,0,0,2H43a1,1,0,0,0,0-2Z"
              />
              <path
                [attr.fill]="this.extraStuffService.getFillColor(1)"
                d="M43,51H21a1,1,0,0,0,0,2H43a1,1,0,0,0,0-2Z"
              />
            </svg>
            <a
              [ngClass]="{
                'border-dl-green-8 text-dl-tan-1 dark:text-dl-tan-10':
                  getURL() === 'recipes',
                'border-transparent text-dl-tan-4 dark:text-dl-tan-7 ':
                  getURL() !== 'recipes'
              }"
              class="inline-flex items-center border-t-4 px-1 font-sans text-dl-4 font-dl-3"
            >
              Recipes
            </a>
          </div>
        </ng-container>
        <ng-container *ngIf="authService.profile() as profile">
          <div (click)="navigate('/social')" class="flex flex-col">
            <svg
              data-name="Layer 1"
              viewBox="10 14 80 75"
              class="inline-flex items-center"
              height="48"
              width="48"
            >
              <path
                [attr.fill]="this.extraStuffService.getFillColor(3)"
                d="M30,79a11,11,0,0,0,7.87-3.32,23.85,23.85,0,0,0,24.27,0,11,11,0,1,0,11.71-18A23.91,23.91,0,0,0,61,33.67a11,11,0,0,0-22,0,23.91,23.91,0,0,0-12.86,24A11,11,0,0,0,30,79Zm40-6a5,5,0,1,1,5-5A5,5,0,0,1,70,73ZM50,29a5,5,0,1,1-5,5A5,5,0,0,1,50,29ZM40.59,39.68a11,11,0,0,0,18.81,0A18,18,0,0,1,68,55a17.69,17.69,0,0,1-.15,2.21A11,11,0,0,0,59.27,70.4a17.8,17.8,0,0,1-18.54,0,11,11,0,0,0-8.58-13.18A17.69,17.69,0,0,1,32,55,18,18,0,0,1,40.59,39.68ZM30,63a5,5,0,1,1-5,5A5,5,0,0,1,30,63Z"
              />
            </svg>
            <a
              [ngClass]="{
                'border-dl-green-8 text-dl-tan-1 dark:text-dl-tan-10':
                  getURL() === 'social',
                'border-transparent text-dl-tan-4 dark:text-dl-tan-7 ':
                  getURL() !== 'social'
              }"
              class="inline-flex items-center border-t-4 px-1 font-sans text-dl-4 font-dl-3"
            >
              Social
            </a>
          </div>
        </ng-container>
        <ng-container *ngIf="authService.profile() as profile">
          <div (click)="navigate('/kitchen')" class="flex flex-col">
            <svg
              viewBox="-2 1 18 18"
              version="1.1"
              height="48"
              width="48"
              class="inline-flex items-center"
            >
              <g transform="translate(0,6.35)">
                <path
                  [attr.fill]="this.extraStuffService.getFillColor(1)"
                  (click)="navigate('/kitchen')"
                  d="m 6.3815603,-5.5562083 c -0.002,0 -0.005,0 -0.007,2e-5 -0.14602,0.002 -0.26265,0.12229 -0.26059,0.26832 v 2.42127 c -0.0117,-0.0204 -0.0236,-0.041 -0.0358,-0.0615 -0.382922,-0.64675 -1.00835,-1.35144 -1.927437,-1.35144 -0.14762,-0.002 -0.268429,0.11695 -0.268429,0.26459 0,0.14763 0.120809,0.26671 0.268429,0.26457 0.643243,0 1.131718,0.51697 1.472096,1.09186 0.177801,0.30029 0.306271,0.60221 0.388551,0.82229 h -1.581632 c -0.949918,-0.007 -1.684381,0.90813997 -1.471109,1.83380997 l 1.960434,8.62757003 c 1.59e-4,6.9e-4 3.38e-4,10e-4 4.89e-4,0.002 a 0.26460745,0.26460745 0 0 0 1.39e-4,6e-4 c 0.162438,0.70562 0.818586,1.16179 1.459399,1.16179 0.58203,0 1.1767,-0.37634 1.4026,-0.97412 0.20446,0.21081 0.4374,0.39329 0.6928,0.54168 a 0.26460745,0.26460745 0 0 0 6.9e-4,3.8e-4 c 1.5352197,0.8859203 3.5056297,0.35774 4.3919197,-1.17724 0.66509,-1.15148 0.53438,-2.54819 -0.22033,-3.54859 l 1.28618,-1.26734 a 0.26460745,0.26460745 0 0 0 -0.1141,-0.44316 l -1.40099,-0.39379 -1.04151,-1.01641 a 0.26460745,0.26460745 0 0 0 -0.19192,-0.0751 0.26460745,0.26460745 0 0 0 -0.24892,0.19789 l -0.45445,1.74739 c -0.0758,-0.009 -0.15204,-0.0163 -0.2286,-0.0204 a 0.26460745,0.26460745 0 0 0 -4.9e-4,0 c -0.0772,-0.004 -0.15443,-0.005 -0.23142,-0.003 v 0 c -0.3516797,0.007 -0.6990597,0.0724 -1.0283997,0.19177 l 0.80673,-3.55159003 c 0.2109797,-0.91585 -0.50545,-1.82281997 -1.44321,-1.83295997 a 0.26460745,0.26460745 0 0 0 -0.0101,-6.9e-4 0.26460745,0.26460745 0 0 0 -0.003,0 h -1.6e-4 -3.6e-4 -6.9e-4 -1.59506 c 0.0823,-0.22008 0.21076,-0.522 0.38857,-0.8223 0.34037,-0.57488 0.82884,-1.09185 1.47209,-1.09185 0.14762,0.002 0.26843,-0.11695 0.26843,-0.26458 0,-0.14764 -0.12081,-0.26672 -0.26843,-0.26458 -0.9191,0 -1.5445,0.70468 -1.92742,1.35143 -0.0121,0.0205 -0.024,0.0409 -0.0358,0.0615 v -2.42127 c 0.002,-0.14683 -0.11565,-0.26677 -0.2616,-0.26834 z m -1.969998,4.24914 c 0.0048,0 0.0093,0 0.01408,0 v 0 a 0.26460745,0.26460745 0 0 0 0.002,0 h 3.912968 a 0.26460745,0.26460745 0 0 0 5.4e-4,0 c 0.59913,6.9e-4 1.07652,0.60192997 0.94201,1.18585997 a 0.26460745,0.26460745 0 0 0 -1.9e-4,6.9e-4 l -0.37106,1.63376003 h -2.85163 a 0.26460745,0.26460745 0 1 0 0,0.52916 h 2.73143 l -0.87872,3.86849 h -1.85271 a 0.26460745,0.26460745 0 1 0 0,0.52917 h 1.73255 l -0.3611,1.58973 -0.0351,0.15479 a 0.26460745,0.26460745 0 0 0 -7e-5,4.1e-4 l -0.0733,0.32285 a 0.26460745,0.26460745 0 0 0 -1.3e-4,4.4e-4 c 0,2.6e-4 -1.3e-4,5.3e-4 -1.9e-4,6.9e-4 -0.0996,0.4328 -0.57312,0.75132 -0.94371,0.75132 -0.37042,0 -0.843649,-0.31823 -0.943576,-0.75073 v -2.4e-4 c -1.31e-4,-3.8e-4 -1.66e-4,-6.9e-4 -2.62e-4,-10e-4 a 0.26460745,0.26460745 0 0 0 -1.39e-4,-4.7e-4 l -0.96947,-4.26656 h 2.396517 a 0.26460745,0.26460745 0 1 0 0,-0.52916 h -2.422051 a 0.26460745,0.26460745 0 0 0 -0.09125,0.0152 l -0.874325,-3.84780003 a 0.26460745,0.26460745 0 0 0 -1.86e-4,-6.9e-4 c -0.134256,-0.58268 0.341134,-1.18118997 0.937182,-1.18587997 z m 6.9214377,3.51518 0.76363,0.74522 a 0.26460745,0.26460745 0 0 0 0.11319,0.0653 l 1.02719,0.28872 -0.94328,0.92948 c -0.17897,-0.16947 -0.3803,-0.32084 -0.60285,-0.44936 -0.21874,-0.12634 -0.45082,-0.22599 -0.69126,-0.29753 z m -1.25311,1.67776 c 0.0483,-1.5e-4 0.0966,6.9e-4 0.14495,0.003 0.42296,0.0224 0.83461,0.14453 1.20139,0.35637 1.28757,0.74363 1.72642,2.38248 0.98274,3.67001 -0.7433,1.28737 -2.38162,1.72654 -3.6691797,0.98358 -0.31269,-0.18179 -0.5845,-0.42512 -0.80063,-0.71417 l 0.90764,-3.99345 c 0.36689,-0.19128 0.77198,-0.29661 1.1849297,-0.30526 h -6e-5 c 0.0161,-3.3e-4 0.0321,-5.3e-4 0.0482,-5.7e-4 z"
                />
              </g>
            </svg>
            <a
              [ngClass]="{
                'border-dl-green-8 text-dl-tan-1 dark:text-dl-tan-10':
                  getURL() === 'kitchen',
                'border-transparent text-dl-tan-4 dark:text-dl-tan-7 ':
                  getURL() !== 'kitchen'
              }"
              class="inline-flex items-center border-t-4 px-1 font-sans text-dl-4 font-dl-3"
            >
              Kitchen
            </a>
          </div>
        </ng-container>
        <!-- Profile dropdown -->
        <div
          *ngIf="authService.profile() as profile"
          class="relative pb-dl-3 pr-dl-3"
        >
          <div>
            <button
              type="button"
              (click)="toggleMenu($event)"
              class="flex rounded-full pb-dl-5 text-sm"
              id="user-menu-button"
              aria-expanded="false"
              aria-haspopup="true"
            >
              <span class="sr-only">Open User Menu</span>
              <img
                *ngIf="profileImageLink"
                class="h-dl-5 w-dl-5 rounded-full focus:outline-none focus:ring-2 focus:ring-dl-green-6 focus:ring-offset-2"
                [src]="profileImageLink | imageFromCDN"
                alt="profile image"
              />
              <span
                class="inline-flex h-dl-5 w-dl-5 items-center justify-center rounded-full bg-dl-tan-8 dark:bg-dl-tan-3"
                *ngIf="!profileImageLink && initials"
              >
                <span
                  class="font-sans text-dl-4 font-dl-3 leading-none text-dl-tan-3 dark:text-dl-tan-9"
                  >{{ initials }}</span
                >
              </span>
              <span
                *ngIf="!profileImageLink && !initials"
                class="inline-block h-dl-5 w-dl-5 overflow-hidden rounded-full bg-dl-tan-9 dark:bg-dl-tan-3"
              >
                <svg
                  class="h-full w-full text-dl-tan-3 dark:text-dl-tan-9"
                  fill="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"
                  />
                </svg>
              </span>
            </button>
          </div>
          <div
            #menu
            *ngIf="isMenuOpen"
            [ngClass]="{
              'scale-100 opacity-100 duration-200': isMenuOpen,
              'scale-95 opacity-0 duration-75': !isMenuOpen
            }"
            class="absolute bottom-28 right-5 z-20 flex w-dl-8 flex-col items-center rounded-md bg-dl-tan-10 py-1 shadow-lg ring-1 ring-dl-tan-1 ring-opacity-5 ease-out focus:outline-none dark:border dark:border-dl-tan-4 dark:bg-dl-tan-1"
            role="menu"
            aria-orientation="vertical"
            aria-labelledby="user-menu-button"
            tabindex="-1"
          >
            <a
              (click)="profileNavigate('/profile')"
              class="cursor-pointer px-2 py-1 font-sans text-dl-5 font-dl-3 text-dl-tan-3 dark:text-dl-tan-8"
              role="menuitem"
              tabindex="-1"
              id="user-menu-item-0"
            >
              Profile
            </a>
            <a
              (click)="profileNavigate('/settings')"
              class="cursor-pointer px-2 py-1 font-sans text-dl-5 font-dl-3 text-dl-tan-3 dark:text-dl-tan-8"
              role="menuitem"
              tabindex="-1"
              id="user-menu-item-1"
            >
              Settings
            </a>
            <a
              (click)="onMessagesClick()"
              class="cursor-pointer px-2 py-1 font-sans text-dl-5 font-dl-3"
              [ngClass]="{
                'bg-dl-pinknew-10 text-dl-tan-3 dark:bg-dl-pinknew-7 dark:text-dl-tan-8':
                  unackedMessageLength() > 0,
                'text-dl-tan-3 dark:text-dl-tan-8': unackedMessageLength() === 0
              }"
              role="menuitem"
              tabindex="-1"
              id="user-menu-item-2"
            >
              Messages
            </a>
            <a
              (click)="logout()"
              class="cursor-pointer px-2 py-1 font-sans text-dl-5 font-dl-3 text-dl-tan-3 dark:text-dl-tan-8"
              role="menuitem"
              tabindex="-1"
              id="user-menu-item-2"
            >
              Sign out
            </a>
          </div>
          <div
            *ngIf="unackedMessageLength() > 0"
            class="absolute -top-1 right-3 z-20 h-dl-2.5 w-dl-2.5 rounded-full bg-dl-pinknew-4 dark:bg-dl-pinknew-7"
          ></div>
        </div>
      </div>
    </div>
  </nav>
</div>
