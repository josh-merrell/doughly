<div
  class="relative w-full transform overflow-hidden bg-white px-dl-5 pb-dl-4 pt-dl-3 text-left transition-all"
>
  <!-- Header -->
  <div class="relative mx-dl-2 mt-dl-3 flex w-full justify-between">
    <h2 class="text-dl-8 font-dl-3 leading-dl-2 text-dl-grey-2">
      {{ tool.name }}
    </h2>
    <svg
      class="mr-dl-3 mt-dl-4"
      width="35"
      height="35"
      viewBox="0 0 15 15"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      (click)="toggleMenu($event)"
    >
      <path
        d="M3.625 7.5C3.625 8.12132 3.12132 8.625 2.5 8.625C1.87868 8.625 1.375 8.12132 1.375 7.5C1.375 6.87868 1.87868 6.375 2.5 6.375C3.12132 6.375 3.625 6.87868 3.625 7.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM12.5 8.625C13.1213 8.625 13.625 8.12132 13.625 7.5C13.625 6.87868 13.1213 6.375 12.5 6.375C11.8787 6.375 11.375 6.87868 11.375 7.5C11.375 8.12132 11.8787 8.625 12.5 8.625Z"
        fill="currentColor"
        fill-rule="evenodd"
        clip-rule="evenodd"
      ></path>
    </svg>
    <div
      #dropdownMenu
      *ngIf="menuOpen"
      class="focus:outling-none absolute right-5 top-12 z-10 flex flex-col bg-white shadow-md ring-1 ring-dl-grey-1 ring-opacity-5 ease-out"
    >
      <button
        (click)="openEditToolDialog()"
        type="button"
        class="block cursor-pointer px-dl-3 py-dl-2 text-dl-5 text-dl-grey-3 hover:bg-dl-grey-10"
      >
        Edit
      </button>
      <button
        (click)="openDeleteToolDialog()"
        type="button"
        class="block cursor-pointer px-dl-3 py-dl-2 text-dl-5 text-dl-grey-3 hover:bg-dl-grey-10"
      >
        Delete
      </button>
    </div>
  </div>

  <!-- Inventory-->
  <div>
    <!--Header-->
    <div class="mx-dl-1 mt-dl-4 flex w-full items-center justify-between">
      <h3 class="pt-dl-3 text-dl-6 font-dl-3 leading-dl-2 text-dl-grey-2">
        Inventory
      </h3>
      <button
        id="test-button"
        type="button"
        class="mt-dl-5 block h-dl-4 whitespace-nowrap rounded-dl-1 bg-dl-pink-4 px-dl-3 py-dl-2 text-center text-dl-4 font-dl-3 text-white shadow-sm transition-all duration-200 ease-in-out hover:bg-dl-pink-5 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-dl-pink-6"
        (click)="onAddStock()"
      >
        Add Inventory
      </button>
    </div>

    <!-- Stock Entries-->
    <div class="h-max-dl-10 mx-dl-4 mt-dl-4 flex flex-col">
      <div
        *ngFor="let stock of toolStocks$ | async; let i = index"
        class="my-dl-2 flex h-dl-4 w-full items-center justify-between rounded-dl-2 px-dl-4"
        [ngClass]="{
          'bg-dl-grey-9': menuOpenForIndex === i,
          'bg-dl-grey-10': menuOpenForIndex !== i
        }"
      >
        <!-- Quantity-->
        <div class="flex">
          <p class="text-dl-5 font-dl-3 text-dl-grey-1">
            {{ stock.quantity }}
          </p>
        </div>

        <!-- Expiration and Dropdown -->
        <div class="flex items-center">
          <div class="relative flex items-center">
            <svg
              class="mx-dl-3"
              width="35"
              height="35"
              viewBox="0 0 15 15"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              (click)="toggleStockMenu($event, i)"
            >
              <path
                d="M3.625 7.5C3.625 8.12132 3.12132 8.625 2.5 8.625C1.87868 8.625 1.375 8.12132 1.375 7.5C1.375 6.87868 1.87868 6.375 2.5 6.375C3.12132 6.375 3.625 6.87868 3.625 7.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM12.5 8.625C13.1213 8.625 13.625 8.12132 13.625 7.5C13.625 6.87868 13.1213 6.375 12.5 6.375C11.8787 6.375 11.375 6.87868 11.375 7.5C11.375 8.12132 11.8787 8.625 12.5 8.625Z"
                fill="currentColor"
                fill-rule="evenodd"
                clip-rule="evenodd"
              ></path>
            </svg>
            <div
              #stockDropdownMenu
              *ngIf="menuOpenForIndex === i"
              class="focus:outling-none absolute right-5 top-12 z-10 flex flex-col bg-white shadow-md ring-1 ring-dl-grey-1 ring-opacity-5 ease-out"
            >
              <button
                (click)="openEditStockDialog(stock.toolStockID)"
                type="button"
                class="block cursor-pointer px-dl-3 py-dl-2 text-dl-5 text-dl-grey-3 hover:bg-dl-grey-10"
              >
                Edit
              </button>
              <button
                (click)="openDeleteStockDialog(stock.toolStockID)"
                type="button"
                class="block cursor-pointer px-dl-3 py-dl-2 text-dl-5 text-dl-grey-3 hover:bg-dl-grey-10"
              >
                Delete
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tool Recipes -->
  <div class="mx-dl-1 mt-dl-5 flex flex-col">
    <h3 class="pt-dl-3 text-dl-6 font-dl-3 leading-dl-2 text-dl-grey-2">
      Recipes
    </h3>
    <div class="mt-dl-2 flex flex-wrap p-dl-2">
      <ng-container *ngFor="let recipe of displayRecipes$ | async">
        <div
          *ngIf="recipe.status === 'published'"
          class="my-dl-2 flex h-dl-4 w-full items-center justify-between rounded-dl-2 bg-dl-grey-10 px-dl-4"
          (click)="onRecipeClick(recipe.recipeID)"
        >
          <p class="text-dl-5 font-dl-3 text-dl-grey-1">{{ recipe.title }}</p>
          <p class="mt-dl-2 text-dl-5 font-dl-2 text-dl-grey-4">
            {{ recipe.category }}
          </p>
          <p
            *ngIf="
              !recipe.shoppingList.tools || !recipe.shoppingList.tools.length
            "
            class="text-dl-5 font-dl-2 italic text-dl-teal-7"
          >
            Ready to Make
          </p>
        </div>
      </ng-container>
    </div>
  </div>
</div>
